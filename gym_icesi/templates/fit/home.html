{% extends 'base.html' %}
{% block title %}Dashboard - Gym Icesi{% endblock %}

{% block content %}
<div style="margin-bottom:2rem;">
  <h1>Hola, {{ user.first_name|default:user.username }} ğŸ‘‹</h1>
  <p>Bienvenido a tu panel de control fitness. AquÃ­ puedes ver tu progreso y gestionar tus rutinas.</p>
</div>

<!-- Stats Cards -->
<div class="stats-grid">
  <div class="stat-card">
    <span class="stat-icon">ğŸ“‹</span>
    <div class="stat-value">{{ total_routines }}</div>
    <div class="stat-label">Rutinas Creadas</div>
  </div>

  <div class="stat-card">
    <span class="stat-icon">ğŸ”¥</span>
    <div class="stat-value">{{ total_sessions }}</div>
    <div class="stat-label">Sesiones Total</div>
  </div>

  <div class="stat-card">
    <span class="stat-icon">ğŸ“…</span>
    <div class="stat-value">{{ active_days }}</div>
    <div class="stat-label">DÃ­as Activos/Mes</div>
  </div>

  <div class="stat-card">
    <span class="stat-icon">ğŸ’ª</span>
    <div class="stat-value">{{ avg_effort }}</div>
    <div class="stat-label">Esfuerzo Promedio</div>
  </div>
</div>

<div class="row">
  <!-- Mis Rutinas -->
  <div class="col">
    <div class="card">
      <h3>ğŸ“‹ Mis Rutinas Recientes</h3>
      {% if my_routines %}
        <ul class="routine-list">
          {% for routine in my_routines %}
            <li>
              <a href="{% url 'routine_detail' routine.pk %}" class="action-link">
                {{ routine.nombre }}
              </a>
              {% if routine.es_predisenada %}
                <span class="badge badge-success">PrediseÃ±ada</span>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
        <a href="{% url 'routine_list' %}" class="btn btn-sm">Ver todas las rutinas â†’</a>
      {% else %}
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ“</div>
          <p>No tienes rutinas aÃºn. Â¡Crea tu primera rutina!</p>
          <a href="{% url 'routine_create' %}" class="btn">Crear Rutina</a>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Progreso Reciente -->
  <div class="col">
    <div class="card">
      <h3>âœ… Progreso Reciente</h3>
      {% if latest %}
        <ul class="exercise-list">
          {% for log in latest %}
            <li>
              <div class="routine-item-info">
                <div class="routine-item-title">{{ log.routine.nombre }}</div>
                <div class="routine-item-meta">
                  {{ log.fecha|date:"d M Y" }} |
                  {% if log.repeticiones %}{{ log.repeticiones }} reps{% endif %}
                  {% if log.tiempo_seg %}{{ log.tiempo_seg }}s{% endif %} |
                  Esfuerzo: <span class="badge badge-primary">{{ log.esfuerzo }}/10</span>
                </div>
              </div>
            </li>
          {% endfor %}
        </ul>
        <a href="{% url 'progress_create' %}" class="btn btn-sm btn-success">Registrar nueva sesiÃ³n â†’</a>
      {% else %}
        <div class="empty-state">
          <div class="empty-state-icon">ğŸ“Š</div>
          <p>No has registrado progreso aÃºn.</p>
          <a href="{% url 'progress_create' %}" class="btn btn-success">Registrar Progreso</a>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Acciones RÃ¡pidas -->
<div class="card" style="background:linear-gradient(135deg, #0b74de 0%, #4a7c59 100%);color:white;margin-top:1.5rem;">
  <h3 style="color:white;">âš¡ Acciones RÃ¡pidas</h3>
  <div style="display:flex;gap:1rem;margin-top:1rem;flex-wrap:wrap;">
    <a href="{% url 'routine_create' %}" class="btn" style="background:white;color:#0b74de;">â• Nueva Rutina</a>
    <a href="{% url 'exercise_create' %}" class="btn" style="background:rgba(255,255,255,0.2);border:2px solid white;">ğŸ’ª Crear Ejercicio</a>
    <a href="{% url 'progress_create' %}" class="btn" style="background:rgba(255,255,255,0.2);border:2px solid white;">âœ… Registrar Progreso</a>
    <a href="{% url 'report_adherence' %}" class="btn" style="background:rgba(255,255,255,0.2);border:2px solid white;">ğŸ“Š Ver Informes</a>
  </div>
</div>

<!-- Recomendaciones no leÃ­das -->
{% if unread_recommendations > 0 %}
<div class="card" style="background:#fef3c7;border-color:#fde68a;margin-top:1.5rem;">
  <h3 style="color:#92400e;">ğŸ’¬ Tienes {{ unread_recommendations }} recomendaciÃ³n{{ unread_recommendations|pluralize:"es" }} nueva{{ unread_recommendations|pluralize }}</h3>
  <p style="color:#78350f;margin-bottom:1rem;">
    Tu entrenador te ha enviado recomendaciones. Â¡RevÃ­salas para mejorar tu rendimiento!
  </p>
  <a href="{% url 'recommendations_list' %}" class="btn" style="background:#92400e;color:white;">Ver Recomendaciones</a>
</div>
{% endif %}
{% endblock %}
